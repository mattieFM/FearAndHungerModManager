

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: commonLibs/_common/betterCrowMauler.js | Source: commonLibs/_common/betterCrowMauler.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
        
            <link type="text/css" rel="stylesheet" href="./api.css">
        
    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 150px; height: 150px">
        
            <a href="./index.html" rel="noopener noreferrer" target="_blank">
                <img src="https://github.com/mattieFM/FearAndHungerModManager/blob/main/www/mods/commonLibs/_common/images/logo.png?raw=true" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: commonLibs/_common/betterCrowMauler.js</a></h1>
        
            <span class="version">v1.0.0</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Tutorials</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Tutorials</h3><ul><li><a href="tutorial-install.html">INSTALL</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="install_sub"></div></li><li><a href="tutorial-tmp.html">tmp</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="tmp_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="CommonMod.html">CommonMod</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CommonMod_sub"></div></li><li><a href="MapEvent.html">MapEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="MapEvent_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="MapEvent.html#.generateImage">generateImage</a></li><li><a href="MapEvent.html#.generateImage">generateImage</a></li><li><a href="MapEvent.html#.setDefaultImage">setDefaultImage</a></li><li><a href="MapEvent.html#.setDefaultImage">setDefaultImage</a></li><li><a href="MapEvent.html#addCommand">addCommand</a></li><li><a href="MapEvent.html#addCommand">addCommand</a></li><li><a href="MapEvent.html#addCommandAfterIndex">addCommandAfterIndex</a></li><li><a href="MapEvent.html#addCommandAfterIndex">addCommandAfterIndex</a></li><li><a href="MapEvent.html#addPage">addPage</a></li><li><a href="MapEvent.html#addPage">addPage</a></li><li><a href="MapEvent.html#addSpriteToTilemap">addSpriteToTilemap</a></li><li><a href="MapEvent.html#addSpriteToTilemap">addSpriteToTilemap</a></li><li><a href="MapEvent.html#checkSelfSwitch">checkSelfSwitch</a></li><li><a href="MapEvent.html#checkSelfSwitch">checkSelfSwitch</a></li><li><a href="MapEvent.html#copyActionsFromCommonEvent">copyActionsFromCommonEvent</a></li><li><a href="MapEvent.html#copyActionsFromCommonEvent">copyActionsFromCommonEvent</a></li><li><a href="MapEvent.html#copyActionsFromEvent">copyActionsFromEvent</a></li><li><a href="MapEvent.html#copyActionsFromEvent">copyActionsFromEvent</a></li><li><a href="MapEvent.html#copyActionsFromEventOnMap">copyActionsFromEventOnMap</a></li><li><a href="MapEvent.html#copyActionsFromEventOnMap">copyActionsFromEventOnMap</a></li><li><a href="MapEvent.html#createCharacterSprite">createCharacterSprite</a></li><li><a href="MapEvent.html#createCharacterSprite">createCharacterSprite</a></li><li><a href="MapEvent.html#createCommand">createCommand</a></li><li><a href="MapEvent.html#createCommand">createCommand</a></li><li><a href="MapEvent.html#createGameEvent">createGameEvent</a></li><li><a href="MapEvent.html#createGameEvent">createGameEvent</a></li><li><a href="MapEvent.html#getLastEvent">getLastEvent</a></li><li><a href="MapEvent.html#getLastEvent">getLastEvent</a></li><li><a href="MapEvent.html#getListOfCommandCodesOnPage">getListOfCommandCodesOnPage</a></li><li><a href="MapEvent.html#getListOfCommandCodesOnPage">getListOfCommandCodesOnPage</a></li><li><a href="MapEvent.html#indexOfCommandOnPage">indexOfCommandOnPage</a></li><li><a href="MapEvent.html#indexOfCommandOnPage">indexOfCommandOnPage</a></li><li><a href="MapEvent.html#setDefaultConditions">setDefaultConditions</a></li><li><a href="MapEvent.html#setDefaultConditions">setDefaultConditions</a></li><li><a href="MapEvent.html#setDefaultMoveRoute">setDefaultMoveRoute</a></li><li><a href="MapEvent.html#setDefaultMoveRoute">setDefaultMoveRoute</a></li><li><a href="MapEvent.html#setId">setId</a></li><li><a href="MapEvent.html#setId">setId</a></li><li><a href="MapEvent.html#setImage">setImage</a></li><li><a href="MapEvent.html#setImage">setImage</a></li><li><a href="MapEvent.html#setName">setName</a></li><li><a href="MapEvent.html#setName">setName</a></li><li><a href="MapEvent.html#setNote">setNote</a></li><li><a href="MapEvent.html#setNote">setNote</a></li><li><a href="MapEvent.html#setPosition">setPosition</a></li><li><a href="MapEvent.html#setPosition">setPosition</a></li><li><a href="MapEvent.html#spawn">spawn</a></li><li><a href="MapEvent.html#spawn">spawn</a></li></ul></div></li><li><a href="MATTIE.betterCrowMauler.CrowController.html">CrowController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="MATTIE.betterCrowMauler.CrowController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="MATTIE.betterCrowMauler.CrowController.html#hasSpawned">hasSpawned</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#hasSpawned">hasSpawned</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#inBattle">inBattle</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#inBattle">inBattle</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#mapId">mapId</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#mapId">mapId</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#onScreen">onScreen</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#onScreen">onScreen</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#self">self</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#self">self</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="MATTIE.betterCrowMauler.CrowController.html#canFollow">canFollow</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#canFollow">canFollow</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#crowCanSpawn">crowCanSpawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#crowCanSpawn">crowCanSpawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#disableBaseCrowMauler">disableBaseCrowMauler</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#disableBaseCrowMauler">disableBaseCrowMauler</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#enter">enter</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#enter">enter</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#findClosestSpawnPoint">findClosestSpawnPoint</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#findClosestSpawnPoint">findClosestSpawnPoint</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#follow">follow</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#follow">follow</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#getAllTransferPointsOnMap">getAllTransferPointsOnMap</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#getAllTransferPointsOnMap">getAllTransferPointsOnMap</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#getScaling">getScaling</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#getScaling">getScaling</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#invadeBattle">invadeBattle</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#invadeBattle">invadeBattle</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#isDead">isDead</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#isDead">isDead</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#shouldDespawn">shouldDespawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#shouldDespawn">shouldDespawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#shouldEnterCombat">shouldEnterCombat</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#shouldEnterCombat">shouldEnterCombat</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#spawn">spawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#spawn">spawn</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#spawnTick">spawnTick</a></li><li><a href="MATTIE.betterCrowMauler.CrowController.html#spawnTick">spawnTick</a></li></ul></div></li><li><a href="ModManager.html">ModManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ModManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ModManager.html#addModEntry">addModEntry</a></li><li><a href="ModManager.html#addModEntry">addModEntry</a></li><li><a href="ModManager.html#addOffloadScriptToMod">addOffloadScriptToMod</a></li><li><a href="ModManager.html#addOffloadScriptToMod">addOffloadScriptToMod</a></li><li><a href="ModManager.html#addOnloadScriptToMod">addOnloadScriptToMod</a></li><li><a href="ModManager.html#addOnloadScriptToMod">addOnloadScriptToMod</a></li><li><a href="ModManager.html#callOnLoadModScript">callOnLoadModScript</a></li><li><a href="ModManager.html#callOnLoadModScript">callOnLoadModScript</a></li><li><a href="ModManager.html#callOnOffloadModScript">callOnOffloadModScript</a></li><li><a href="ModManager.html#callOnOffloadModScript">callOnOffloadModScript</a></li><li><a href="ModManager.html#checkForceModdedSaves">checkForceModdedSaves</a></li><li><a href="ModManager.html#checkForceModdedSaves">checkForceModdedSaves</a></li><li><a href="ModManager.html#checkForceVanillaSaves">checkForceVanillaSaves</a></li><li><a href="ModManager.html#checkForceVanillaSaves">checkForceVanillaSaves</a></li><li><a href="ModManager.html#checkMod">checkMod</a></li><li><a href="ModManager.html#checkMod">checkMod</a></li><li><a href="ModManager.html#checkModded">checkModded</a></li><li><a href="ModManager.html#checkModded">checkModded</a></li><li><a href="ModManager.html#checkModsChanged">checkModsChanged</a></li><li><a href="ModManager.html#checkModsChanged">checkModsChanged</a></li><li><a href="ModManager.html#checkSaveDanger">checkSaveDanger</a></li><li><a href="ModManager.html#checkSaveDanger">checkSaveDanger</a></li><li><a href="ModManager.html#checkVanilla">checkVanilla</a></li><li><a href="ModManager.html#checkVanilla">checkVanilla</a></li><li><a href="ModManager.html#disableAndReload">disableAndReload</a></li><li><a href="ModManager.html#disableAndReload">disableAndReload</a></li><li><a href="ModManager.html#generateDefaultJSONForMod">generateDefaultJSONForMod</a></li><li><a href="ModManager.html#generateDefaultJSONForMod">generateDefaultJSONForMod</a></li><li><a href="ModManager.html#generateDefaultJsonForModsWithoutJsons">generateDefaultJsonForModsWithoutJsons</a></li><li><a href="ModManager.html#generateDefaultJsonForModsWithoutJsons">generateDefaultJsonForModsWithoutJsons</a></li><li><a href="ModManager.html#getActiveRealDangerMods">getActiveRealDangerMods</a></li><li><a href="ModManager.html#getActiveRealDangerMods">getActiveRealDangerMods</a></li><li><a href="ModManager.html#getActiveRealMods">getActiveRealMods</a></li><li><a href="ModManager.html#getActiveRealMods">getActiveRealMods</a></li><li><a href="ModManager.html#getModInfo">getModInfo</a></li><li><a href="ModManager.html#getModInfo">getModInfo</a></li><li><a href="ModManager.html#getModsFolder">getModsFolder</a></li><li><a href="ModManager.html#getModsFolder">getModsFolder</a></li><li><a href="ModManager.html#getModsWithoutJson">getModsWithoutJson</a></li><li><a href="ModManager.html#getModsWithoutJson">getModsWithoutJson</a></li><li><a href="ModManager.html#getPath">getPath</a></li><li><a href="ModManager.html#getPath">getPath</a></li><li><a href="ModManager.html#parseMod">parseMod</a></li><li><a href="ModManager.html#parseMod">parseMod</a></li><li><a href="ModManager.html#parseMods">parseMods</a></li><li><a href="ModManager.html#parseMods">parseMods</a></li><li><a href="ModManager.html#reloadGame">reloadGame</a></li><li><a href="ModManager.html#reloadGame">reloadGame</a></li><li><a href="ModManager.html#reloadIfChangedGame">reloadIfChangedGame</a></li><li><a href="ModManager.html#reloadIfChangedGame">reloadIfChangedGame</a></li><li><a href="ModManager.html#setEnabled">setEnabled</a></li><li><a href="ModManager.html#setEnabled">setEnabled</a></li><li><a href="ModManager.html#setNonDanger">setNonDanger</a></li><li><a href="ModManager.html#setNonDanger">setNonDanger</a></li><li><a href="ModManager.html#setup">setup</a></li><li><a href="ModManager.html#setup">setup</a></li><li><a href="ModManager.html#setVanilla">setVanilla</a></li><li><a href="ModManager.html#setVanilla">setVanilla</a></li><li><a href="ModManager.html#switchForceModdedSaves">switchForceModdedSaves</a></li><li><a href="ModManager.html#switchForceModdedSaves">switchForceModdedSaves</a></li><li><a href="ModManager.html#switchForceVanillaSaves">switchForceVanillaSaves</a></li><li><a href="ModManager.html#switchForceVanillaSaves">switchForceVanillaSaves</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#MATTIE">MATTIE</a></li><li><a href="global.html#MATTIE_ModManager">MATTIE_ModManager</a></li><li><a href="global.html#overrideErrorLoggers">overrideErrorLoggers</a></li><li><a href="global.html">render</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var MATTIE = MATTIE || {};
var MATTIE_RPG = MATTIE_RPG || {};

MATTIE.betterCrowMauler = MATTIE.betterCrowMauler || {};
/**
 *  @description the number of milliseconds util it is checked if crow mauler can spawn
 *  @default 10000
 * */
MATTIE.betterCrowMauler.spawnInterval = 10000;
/**
 *  @description the chance that crow mauler will spawn every interval
 *  @default .03
 * */
MATTIE.betterCrowMauler.spawnChance = 0.03;

/**
 *  @description the chance that crow mauler will follow you into the next room
 *  @default .2
 * */
MATTIE.betterCrowMauler.followChance = 0.15;

/**
 *  @description the chance that crow mauler will despawn when you leave a room
 *  @default .05
 * */
MATTIE.betterCrowMauler.despawnChance = 0.15;

/**
 * @description the chance of crow mauler entering someones battle
 * @default .005
 */
MATTIE.betterCrowMauler.combatEnterChance = 0.005;

/**
 * @description the min amount of time that must pass before crow can spawn in ms
 * @default 100 sec
 *
*/
MATTIE.betterCrowMauler.timeToSpawnMin = 100000;

MATTIE.betterCrowMauler.timeToSpawnMax = 10000000;
MATTIE.betterCrowMauler.timeScaler = (t) => (0.2 + (10 * (t / MATTIE.betterCrowMauler.timeToSpawnMax)));

/** @description a scaler to scale the crow's spawn chance by */
MATTIE.betterCrowMauler.scaler = 1;

/** @class */
MATTIE.betterCrowMauler.CrowController = function () {
	setTimeout(() => {
		this.disableBaseCrowMauler();
	}, 5000);

	this.timeElapsed = 0;

	/** @description whether this instance of the controller has spawned a crow mauler on this level */
	this.hasSpawned = false;

	/** @description whether a crow mauler has forced its way into this combat */
	this.inBattle = false;

	/** @description whether this instance of the controller's crow mauler is on screen or not  */
	this.onScreen = false;

	/** @description the id of the mapId crow mauler was spawned in last */
	this.mapId = 0;
	/**
     * @description The current crow obj if spawned
     * @type {MapEvent}
     * */
	this.self = new MapEvent();

	const prevFunc = Game_Player.prototype.performTransfer;
	const that = this;
	Game_Player.prototype.performTransfer = function () {
		prevFunc.call(this);
		that.onEnterRoom();
		this.inBattle = false;
	};

	setInterval(() => {
		this.timeElapsed += MATTIE.betterCrowMauler.spawnInterval;
		if (this.crowCanSpawn()) {
			if ((!MATTIE.static.maps.onMenuMap())) { this.spawnTick(); }
			this.battleSpawnTick();
		}
	}, MATTIE.betterCrowMauler.spawnInterval);
};

/** @description whether this instance's crow mauler is dead */
MATTIE.betterCrowMauler.CrowController.prototype.isDead = function () {
	const bool = this.self.checkSelfSwitch('A');
	console.log(`isdead: ${bool}`);
	return bool;
};

/** @description a function to return the scaler, ment to be overriden if other mods need to change this */
MATTIE.betterCrowMauler.CrowController.prototype.getScaling = function () {
	return MATTIE.betterCrowMauler.scaler * MATTIE.betterCrowMauler.timeScaler(this.timeElapsed);
};

/**
 * @description disable crow mauler
 * @todo make sure this works properly
 */
MATTIE.betterCrowMauler.CrowController.prototype.disableBaseCrowMauler = function () {
	$gameSwitches.setValue(MATTIE.static.switch.crowMaulerDisabled, true);
};

/**
 * @description the function called every x ms to check if crow mauler should spawn
 */
MATTIE.betterCrowMauler.CrowController.prototype.spawnTick = function () {
	if (!this.onScreen &amp;&amp; !this.hasSpawned &amp;&amp; !this.isDead() &amp;&amp; !$gameParty.inBattle() &amp;&amp; SceneManager._scene instanceof Scene_Map) this.update();
};

MATTIE.betterCrowMauler.CrowController.prototype.battleSpawnTick = function () {
	if (!this.isDead() &amp;&amp; $gameParty.inBattle() &amp;&amp; this.shouldEnterCombat() &amp;&amp; !this.inBattle) {
		MATTIE.msgAPI.footerMsg('A terrifying presence has entered the room...');
		MATTIE.msgAPI.footerMsg('A terrifying presence is getting closer');

		setTimeout(() => {
			MATTIE.msgAPI.footerMsg('A terrifying presence is behind you');

			setTimeout(() => {
				this.invadeBattle();
			}, 35000);
		}, 5000);
	}
};

/** @description spawns crow mauler into the current battle */
MATTIE.betterCrowMauler.CrowController.prototype.invadeBattle = function (net = false) {
	if ($gameParty.inBattle()) {
		this.inBattle = true;
		const additionalTroop = new MATTIE.troopAPI.RuntimeTroop(MATTIE.static.troops.crowMauler, 500, 0);
		additionalTroop.spawn(net);
	}
};

/**
 * @description checks if crow mauler can spawn
 * @returns {boolean}
 */
MATTIE.betterCrowMauler.CrowController.prototype.crowCanSpawn = function () {
	return $gameSwitches.value(MATTIE.static.switch.crowMaulerCanSpawn)
	&amp;&amp; !$gameSwitches.value(MATTIE.static.switch.crowMaulerDead)
	&amp;&amp; this.timeElapsed > MATTIE.betterCrowMauler.timeToSpawnMin;
};

/**
 * @description get all possible entry or exit event tiles in the room
 * @returns an array of every event that has an active transfer event in its list
 */
MATTIE.betterCrowMauler.CrowController.prototype.getAllTransferPointsOnMap = function () {
	let arr = [];
	if ($gameMap) {
		arr = $gameMap.events().filter((event) => {
			if (event.event()) {
				const page = event.event().pages[event._pageIndex];
				if (page) {
					return page.list.map((cmd) => cmd.code).includes(MATTIE.static.commands.transferId);
				}
				return false;
			}
			return false;
		});
	}

	return arr;
};

/**
 * @description find the closest spawn point to a provided x and y
 * @param {int} x;
 * @param {int} y;
 * @returns {Game_Event} the closest possible spawn point to the players current x and y
 */
MATTIE.betterCrowMauler.CrowController.prototype.findClosestSpawnPoint = function (x, y) {
	const spawnPoints = this.getAllTransferPointsOnMap();
	let closest = spawnPoints[0];
	if (closest) {
		let dist = MATTIE.util.getDist(x, closest.x, y, closest.y);
		for (let index = 1; index &lt; spawnPoints.length; index++) {
			/** @type {Game_Event} */
			const element = spawnPoints[index];
			const thisDist = MATTIE.util.getDist(x, element.x, y, element.y);
			if (thisDist &lt; dist) {
				if (MATTIE.isPassableAnyDir(element)) {
					dist = thisDist;
					closest = element;
				}
			}
		}
	}
	return closest;
};

MATTIE.betterCrowMauler.CrowController.prototype.createCrowObj = function () {
	const event = MATTIE.eventAPI.createEnemyFromExisting(53, 207, 2, 9);
	return event;
};

/**
 * @description crow mauler enter the room
 */
MATTIE.betterCrowMauler.CrowController.prototype.enter = function () {
	MATTIE.msgAPI.footerMsg('A terrifying presence has entered the room...');
	this.spawn();
};

/**
 * @description spawn the crow mauler event removing the previous one if it exists
 */
MATTIE.betterCrowMauler.CrowController.prototype.spawn = function () {
	this.timeElapsed = 0;
	if (!this.hasSpawned &amp;&amp; !this.isDead() &amp;&amp; !$gameParty.inBattle()) {
		this.onScreen = true;
		const spot = this.findClosestSpawnPoint($gamePlayer.x, $gamePlayer.y);
		if (spot) {
			this.self = this.createCrowObj();
			this.self.spawn(spot.x, spot.y);

			this.mapId = $gameMap.mapId();
			this.hasSpawned = true;
		}
	}
};

/**
 * @description crow mauler follow player from last room to this room
 */
MATTIE.betterCrowMauler.CrowController.prototype.follow = function () {
	setTimeout(() => {
		MATTIE.msgAPI.footerMsg('A terrifying presence has followed you into the room...');
	}, 4000);
	setTimeout(() => {
		this.spawn();
	}, 6000);
};

/**
 * @description checks if the crow mauler can follow the player, if the crow mauler was in the last room and rand chance.
 *
 * */
MATTIE.betterCrowMauler.CrowController.prototype.canFollow = function () {
	return MATTIE.util.randChance(MATTIE.betterCrowMauler.followChance * this.getScaling()) &amp;&amp; (this.mapId === $gameMap.lastMapId());
};

/**
 * @description checks a random chance to see if the crow should despawn
 *
 * */
MATTIE.betterCrowMauler.CrowController.prototype.shouldDespawn = function () {
	return !this.isDead() &amp;&amp; MATTIE.util.randChance(MATTIE.betterCrowMauler.despawnChance);
};

/**
 * @description checks a random chance to see if the crow should appear in combat
 *
 * */

MATTIE.betterCrowMauler.CrowController.prototype.shouldEnterCombat = function () {
	return !this.isDead() &amp;&amp; !this.onScreen &amp;&amp; MATTIE.util.randChance(MATTIE.betterCrowMauler.combatEnterChance * this.getScaling());
};

MATTIE.betterCrowMauler.CrowController.prototype.despawn = function () {
	if (!this.isDead()) {
		this.self.removeThisEvent();
		this.hasSpawned = false;
	}
};

MATTIE.betterCrowMauler.CrowController.prototype.onEnterRoom = function () {
	if ($gameMap.mapId() != this.mapId) this.onScreen = false;
	if (!this.isDead() &amp;&amp; !this.onScreen) {
		if (this.canFollow() &amp;&amp; this.crowCanSpawn()) {
			this.despawn();
			this.follow();
		} else if (this.shouldDespawn()) {
			this.despawn();
		}
	}
};

MATTIE.betterCrowMauler.CrowController.prototype.update = function () {
	console.log('updated');
	if (MATTIE.util.randChance(MATTIE.betterCrowMauler.spawnChance * this.getScaling())) {
		console.log('entered');
		this.enter();
	}
};
/**
 * @description set up the crow mauler class and assign it to the variable we use
 */
MATTIE.betterCrowMauler.betterCrowMaulerInit = function () {
	const crowCont = new MATTIE.betterCrowMauler.CrowController();
	if (MATTIE.betterCrowMauler) { MATTIE.betterCrowMauler.crowCont = crowCont; }
};

/** @description cleanup the crow controller if it exists */
MATTIE.betterCrowMauler.betterCrowMaulerCleanup = function () {
	if (MATTIE.betterCrowMauler) { MATTIE.betterCrowMauler.crowCont = null; }
};

//--------------------------------------------------
// Multiplayer Compatibility
//--------------------------------------------------
MATTIE.betterCrowMauler.multiplayerCompatPRevFunc = MATTIE.betterCrowMauler.CrowController.prototype.getScaling;
if (MATTIE.multiplayer) {
	MATTIE.betterCrowMauler.CrowController.prototype.getScaling = function () {
		if (MATTIE.multiplayer.getCurrentNetController) {
			const netCont = MATTIE.multiplayer.getCurrentNetController();
			return 1 / Object.keys(netCont.netPlayers).length * MATTIE.betterCrowMauler.multiplayerCompatPRevFunc.call(this);
		}
		return MATTIE.betterCrowMauler.scaler;
	};
}
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://github.com/mattieFM/FearAndHungerModManager/blob/main/www/mods/commonLibs/_common/images/logo.png?raw=true" style="width: 150px; height: 150px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
